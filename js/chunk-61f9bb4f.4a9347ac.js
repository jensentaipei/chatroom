(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61f9bb4f"],{"6e6d":function(e,t,n){e.exports=n.p+"img/user.f5615cfa.png"},"7ab9":function(e,t,n){"use strict";n("872f")},"872f":function(e,t,n){},bf48:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),o=n("6e6d"),a=n.n(o),s=Object(c["fb"])("data-v-719c1298");Object(c["H"])("data-v-719c1298");var i={id:"header"},d={style:{"font-size":"28px","font-family":"Comic Sans MS",color:"white"}},l={id:"chat","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},u={key:0},b={class:"messageBox"},r=Object(c["n"])("img",{src:a.a,class:"messageBox__user"},null,-1),m={class:"messageBox__content"},j={class:"messageBox__name"},O={class:"messageBox__message"},g={class:"messageBox__text"},f={class:"messageBox__time"},v={key:1},p={class:"messageBox messageBox--self"},h={class:"messageBox__time"},_={class:"messageBox__content"},x={class:"messageBox__text"},B={id:"inputBottom"},w=Object(c["n"])("span",{id:"page-bottom"},null,-1);Object(c["F"])();var y=s((function(e,t,n,o,a,y){var k=Object(c["N"])("van-nav-bar"),C=Object(c["N"])("van-field"),R=Object(c["O"])("loading");return Object(c["E"])(),Object(c["j"])("div",null,[Object(c["n"])("div",i,[Object(c["n"])(k,{"left-arrow":"",onClickLeft:o.onClickLeft},{title:s((function(){return[Object(c["n"])("span",d,Object(c["R"])(o.roomName),1)]})),_:1},8,["onClickLeft"])]),Object(c["cb"])(Object(c["n"])("div",l,[(Object(c["E"])(!0),Object(c["j"])(c["b"],null,Object(c["L"])(o.message.value,(function(e){return Object(c["E"])(),Object(c["j"])("div",{key:e.id},[e.user!=o.user?(Object(c["E"])(),Object(c["j"])("div",u,[Object(c["n"])("div",b,[r,Object(c["n"])("div",m,[Object(c["n"])("div",j,Object(c["R"])(e.user),1),Object(c["n"])("div",O,[Object(c["n"])("div",g,Object(c["R"])(e.msg),1)])]),Object(c["n"])("div",f,Object(c["R"])(o.timestamp2Date(e.insdt.seconds)),1)])])):(Object(c["E"])(),Object(c["j"])("div",v,[Object(c["n"])("div",p,[Object(c["n"])("div",h,Object(c["R"])(o.timestamp2Date(e.insdt.seconds)),1),Object(c["n"])("div",_,[Object(c["n"])("div",x,Object(c["R"])(e.msg),1)])])]))])})),128))],512),[[R,o.onloading]]),Object(c["n"])("div",B,[Object(c["n"])(C,{modelValue:o.inputMsg,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.inputMsg=e}),placeholder:"輸入訊息內容",onKeyup:Object(c["db"])(o.updateMsg,["enter"])},null,8,["modelValue","onKeyup"])]),w])})),k=(n("d3b7"),n("159b"),n("a1e9")),C=n("5c40"),R=n("6c02"),M=n("17e1"),E=n("d149"),H=n("44c2"),S={name:"ChatRoom",setup:function(){var e,t=Object(H["a"])(),n=t.getCookie,c=Object(E["a"])(),o=c.timestamp2Date,a=Object(R["c"])(),s=Object(R["d"])(),i=M["a"].firestore(),d=a.params.id,l=Object(k["i"])([]),u=Object(k["j"])(""),b=Object(k["j"])(""),r=Object(k["j"])(""),m=Object(k["j"])(!0);function j(t){return new Promise((function(n){e&&e(),e=i.collection("ChatRoom").doc(t).collection("message").orderBy("insdt","asc").onSnapshot((function(e){var t=[];e.forEach((function(e){var n=e.data();n.id=e.id,t.push(n)})),l.value=t,n()}))}))}function O(){var e=new Date,t=i.collection("ChatRoom").doc(d),n=b.value;b.value="",""!==n&&(t.collection("message").add({insdt:e,msg:n,user:u.value}).then((function(){console.log("send msg success")})),t.update({lastMsg:n,lastMsgTime:e}).then((function(){console.log("update data successful")})))}function g(){return new Promise((function(e){var t=i.collection("ChatRoom").doc(d);t.get().then((function(t){var n=t.data().roomName;e(n)}))}))}function f(){s.go(-1)}return Object(C["F"])((function(){var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=document.querySelector("#header").clientHeight,c=document.querySelector("#inputBottom").clientHeight,o=document.querySelector("#chat").style;o.minHeight="".concat(e-(t+c),"px"),o.paddingTop="".concat(t,"px"),o.paddingBottom="".concat(c,"px"),j(d).then((function(){m.value=!1,window.scrollTo(0,e+t+c)})),u.value=n("user"),g().then((function(e){r.value=e}))})),Object(C["G"])((function(){e&&e()})),{message:l,timestamp2Date:o,user:u,inputMsg:b,updateMsg:O,roomName:r,onClickLeft:f,onloading:m}}};n("7ab9");S.render=y,S.__scopeId="data-v-719c1298";t["default"]=S}}]);